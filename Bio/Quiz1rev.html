<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>CIE Biology App</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #a855f7;
            --accent: #ec4899;
            --bg: #0f172a;
            --surface: rgba(30, 41, 59, 0.7);
            --surface-solid: #1e293b;
            --border: rgba(255, 255, 255, 0.08);
            --text: #f8fafc;
            --text-muted: #94a3b8;
            --success: #10b981;
            --success-bg: rgba(16, 185, 129, 0.15);
            --error: #ef4444;
            --error-bg: rgba(239, 68, 68, 0.15);
            --info-bg: rgba(56, 189, 248, 0.1);
            --info-text: #38bdf8;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg);
            /* Deep modern gradient background */
            background-image: 
                radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(236, 72, 153, 0.15) 0px, transparent 50%);
            background-attachment: fixed;
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* --- APP HEADER --- */
        header {
            width: 100%;
            padding: 1rem 1.5rem;
            padding-top: max(1rem, env(safe-area-inset-top));
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand {
            display: flex;
            flex-direction: column;
        }

        h1 {
            font-size: 1.2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .subtitle {
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* --- SEGMENTED CONTROL (TABS) --- */
        .nav-wrapper {
            width: 100%;
            padding: 1rem 5%;
            position: sticky;
            top: 70px; /* Adjust based on header height */
            z-index: 900;
            background: linear-gradient(to bottom, var(--bg) 0%, rgba(15,23,42,0) 100%);
        }

        .segmented-control {
            background: rgba(255, 255, 255, 0.05);
            padding: 4px;
            border-radius: 12px;
            display: flex;
            position: relative;
            border: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-weight: 600;
            font-size: 0.9rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 2;
        }

        .tab-btn.active {
            color: white;
            background: var(--surface-solid);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        /* --- MAIN CONTAINER --- */
        .container {
            width: 100%;
            max-width: 800px;
            padding: 0 5% 80px 5%; /* Bottom padding for scroll space */
            flex: 1;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease forwards;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- REVISION CARDS --- */
        .revision-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        .revision-card h2 {
            font-size: 1.3rem;
            color: white;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .tag {
            font-size: 0.65rem;
            background: var(--accent);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .revision-card h3 {
            color: var(--primary);
            font-size: 1rem;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .revision-card ul {
            padding-left: 1rem;
            color: #cbd5e1;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .revision-card li {
            margin-bottom: 0.5rem;
        }

        .highlight {
            color: var(--info-text);
            font-weight: 600;
        }

        /* --- QUIZ UI --- */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 10px;
            padding: 0 5px;
        }

        .q-counter {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .q-score {
            font-size: 1rem;
            color: var(--success);
            font-weight: 700;
            background: var(--success-bg);
            padding: 4px 12px;
            border-radius: 20px;
        }

        .progress-track {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 1.5rem;
            color: white;
            padding: 0 5px;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option-btn {
            background: var(--surface);
            border: 1px solid var(--border);
            padding: 1.2rem 1.2rem;
            border-radius: 16px;
            color: var(--text);
            text-align: left;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            transition: transform 0.1s, background 0.2s;
            user-select: none;
            -webkit-user-select: none;
            display: flex;
            align-items: center;
        }

        .option-btn:active:not([disabled]) {
            transform: scale(0.98);
            background: rgba(255,255,255,0.1);
        }

        /* Status Colors */
        .option-btn.correct {
            background: var(--success-bg);
            border-color: var(--success);
            color: var(--success);
        }
        
        .option-btn.correct::after {
            content: '‚úì';
            position: absolute;
            right: 1.2rem;
            font-weight: bold;
        }

        .option-btn.wrong {
            background: var(--error-bg);
            border-color: var(--error);
            color: var(--error);
            opacity: 0.8;
        }

        .option-btn.wrong::after {
            content: '‚úï';
            position: absolute;
            right: 1.2rem;
            font-weight: bold;
        }

        /* Explanation Box */
        .explanation-card {
            margin-top: 1.5rem;
            background: linear-gradient(to bottom right, rgba(56, 189, 248, 0.1), rgba(56, 189, 248, 0.05));
            border: 1px solid rgba(56, 189, 248, 0.3);
            border-radius: 16px;
            padding: 1.2rem;
            display: none;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .exp-header {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--info-text);
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .exp-text {
            color: #e0f2fe;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Next Button */
        .next-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 16px;
            border-radius: 16px;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 20px -10px var(--primary);
            display: none;
            user-select: none;
            -webkit-user-select: none;
        }

        .next-btn:active {
            transform: scale(0.98);
        }

        /* Results Screen */
        .results-view {
            text-align: center;
            padding: 2rem 0;
            display: none;
        }

        .score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            border: 8px solid var(--surface-solid);
            background: linear-gradient(145deg, rgba(99, 102, 241, 0.2), rgba(15, 23, 42, 0.5));
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem auto;
            position: relative;
            box-shadow: 0 0 50px rgba(99, 102, 241, 0.2);
        }

        .score-circle span {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(to bottom, white, #cbd5e1);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .score-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: -5px;
        }

        .result-msg {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: white;
        }

        .result-sub {
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

    </style>
</head>
<body>

    <header>
        <div class="brand">
            <h1>CIE Biology</h1>
            <span class="subtitle">Exam Revision Pro</span>
        </div>
        <div style="width: 30px; height: 30px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 8px;"></div>
    </header>

    <div class="nav-wrapper">
        <div class="segmented-control">
            <button class="tab-btn active" onclick="switchTab('revision')">Revision</button>
            <button class="tab-btn" onclick="switchTab('quiz')">Quiz Mode</button>
        </div>
    </div>

    <div class="container">
        
        <!-- REVISION SECTION -->
        <div id="revision-section" class="section active">
            
            <!-- Ch 9 -->
            <div class="revision-card">
                <h2>Transport <span class="tag">Ch 9</span></h2>
                
                <h3>‚ù§Ô∏è The Heart</h3>
                <ul>
                    <li><strong>Double Circulation:</strong> Blood passes heart <span class="highlight">twice</span>. (Pulmonary=Lungs, Systemic=Body).</li>
                    <li><strong>Left Ventricle:</strong> Thickest wall (High pressure to body).</li>
                    <li><strong>Valves:</strong> Prevent backflow (AV & Semilunar).</li>
                    <li><strong>Septum:</strong> Separates Left/Right to stop mixing.</li>
                </ul>

                <h3>ü©∏ Vessels</h3>
                <ul>
                    <li><strong>Arteries:</strong> Away from heart. Thick, elastic, high pressure.</li>
                    <li><strong>Veins:</strong> Into heart. Thin, large lumen, <span class="highlight">Valves</span>.</li>
                    <li><strong>Capillaries:</strong> One cell thick for diffusion.</li>
                </ul>
            </div>

            <!-- Ch 12 -->
            <div class="revision-card">
                <h2>Coordination <span class="tag" style="background:var(--secondary)">Ch 12</span></h2>
                
                <h3>üëÅÔ∏è The Eye</h3>
                <ul>
                    <li><strong>Bright Light:</strong> Circular contract, Radial relax &rarr; Pupil constricts.</li>
                    <li><strong>Focus Near:</strong> Ciliary contract, Lens gets <span class="highlight">Fat</span>.</li>
                    <li><strong>Focus Far:</strong> Ciliary relax, Ligaments pull tight, Lens gets <span class="highlight">Thin</span>.</li>
                </ul>

                <h3>üå± Tropisms</h3>
                <ul>
                    <li><strong>Shoots:</strong> +Phototropism. Auxin moves to <span class="highlight">shaded</span> side &rarr; elongation.</li>
                    <li><strong>Roots:</strong> +Gravitropism. Grow down.</li>
                </ul>
            </div>

            <!-- Ch 13 -->
            <div class="revision-card">
                <h2>Excretion <span class="tag" style="background:#10b981">Ch 13</span></h2>
                
                <h3>üöΩ Kidney Function</h3>
                <ul>
                    <li><strong>Deamination:</strong> Liver turns excess amino acids into Urea.</li>
                    <li><strong>Glomerulus:</strong> Ultrafiltration (Small stuff out).</li>
                    <li><strong>Tubule:</strong> Selective reabsorption (Glucose back in).</li>
                </ul>

                <h3>üå°Ô∏è Homeostasis</h3>
                <ul>
                    <li><strong>Too Hot:</strong> Vasodilation (blood to skin) & Sweating.</li>
                    <li><strong>Too Cold:</strong> Vasoconstriction & Shivering.</li>
                    <li><strong>High Sugar:</strong> Insulin converts Glucose &rarr; Glycogen.</li>
                </ul>
            </div>
            
            <button class="next-btn" style="display:block" onclick="switchTab('quiz')">Start Practice Quiz</button>
        </div>

        <!-- QUIZ SECTION -->
        <div id="quiz-section" class="section">
            
            <div id="quiz-ui">
                <div class="quiz-header">
                    <span class="q-counter" id="q-progress">Q 1/100</span>
                    <span class="q-score" id="q-score">0</span>
                </div>
                
                <div class="progress-track">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>

                <div class="question-text" id="question-text">
                    Loading Question...
                </div>

                <div class="options-grid" id="options-grid">
                    <!-- Options injected here -->
                </div>

                <div id="explanation" class="explanation-card">
                    <div class="exp-header">
                        <span>üí° Explanation</span>
                    </div>
                    <p class="exp-text" id="explanation-text"></p>
                </div>

                <button class="next-btn" id="next-question-btn" onclick="nextQuestion()">Next Question</button>
            </div>

            <div id="result-view" class="results-view">
                <div class="score-circle">
                    <span id="final-score">0%</span>
                </div>
                <h2 class="result-msg" id="result-title">Well Done!</h2>
                <p class="result-sub" id="feedback-text">You've completed the revision.</p>
                <button class="next-btn" style="display:block" onclick="restartQuiz()">Restart Quiz</button>
                <button class="next-btn" style="display:block; background: transparent; border: 1px solid var(--border); margin-top:10px" onclick="switchTab('revision')">Back to Notes</button>
            </div>

        </div>

    </div>

    <script>
        // --- DATA ---
        const quizData = [
             // CHAPTER 9: TRANSPORT IN ANIMALS
            { q: "Which chamber of the heart has the thickest muscular wall?", a: ["Left Ventricle", "Right Ventricle", "Left Atrium", "Right Atrium"], correct: 0, explanation: "The Left Ventricle pumps blood to the entire body (Systemic circulation), requiring high pressure." },
            { q: "Which blood vessel carries oxygenated blood from the lungs to the heart?", a: ["Pulmonary Vein", "Pulmonary Artery", "Aorta", "Vena Cava"], correct: 0, explanation: "The Pulmonary Vein is the ONLY vein carrying oxygenated blood, bringing it from lungs to left atrium." },
            { q: "What is the function of the septum?", a: ["Separate oxygenated and deoxygenated blood", "Prevent backflow", "Pump blood", "Control heart rate"], correct: 0, explanation: "The septum separates left/right sides to prevent mixing, maximizing oxygen delivery efficiency." },
            { q: "Which component of blood is responsible for clotting?", a: ["Platelets", "Red blood cells", "White blood cells", "Plasma"], correct: 0, explanation: "Platelets release chemicals that convert fibrinogen to fibrin to form a clot." },
            { q: "Double circulation means:", a: ["Blood passes heart twice per circuit", "Two hearts", "Flows two directions", "Two chambers"], correct: 0, explanation: "It involves the Pulmonary circuit (lungs) and Systemic circuit (body) in one complete cycle." },
            { q: "Which vessel contains valves?", a: ["Renal Vein", "Renal Artery", "Aorta", "Capillary"], correct: 0, explanation: "Veins have low pressure, so they need valves to prevent backflow." },
            { q: "Main function of RBCs?", a: ["Transport oxygen", "Fight infection", "Clot blood", "Transport urea"], correct: 0, explanation: "RBCs contain haemoglobin which binds to oxygen." },
            { q: "Highest blood pressure is in:", a: ["Aorta", "Vena Cava", "Capillaries", "Pulmonary Vein"], correct: 0, explanation: "The Aorta receives blood directly from the powerful left ventricle contraction." },
            { q: "Coronary arteries function:", a: ["Supply oxygen to heart muscle", "Carry blood to lungs", "From liver", "Connect vessels"], correct: 0, explanation: "The heart muscle needs its own supply of glucose and oxygen for respiration." },
            { q: "Prevents backflow from ventricle to atrium?", a: ["Atrioventricular valve", "Semilunar valve", "Septum", "Coronary artery"], correct: 0, explanation: "AV valves (Tricuspid/Bicuspid) close when ventricles contract." },
            { q: "Causes coronary blockage?", a: ["Cholesterol/Plaque", "Carbon monoxide", "Tar", "Nicotine"], correct: 0, explanation: "High fat diet leads to cholesterol buildup (plaque) in artery walls." },
            { q: "Mineral for haemoglobin?", a: ["Iron", "Calcium", "Magnesium", "Zinc"], correct: 0, explanation: "Iron is the central component of the haemoglobin molecule." },
            { q: "Gut to Liver vessel?", a: ["Hepatic Portal Vein", "Hepatic Vein", "Hepatic Artery", "Mesenteric Artery"], correct: 0, explanation: "Hepatic Portal Vein carries nutrient-rich blood from digestion to the liver." },
            { q: "Capillary characteristic?", a: ["Walls one cell thick", "Thick walls", "Valves", "High pressure"], correct: 0, explanation: "One cell thick walls minimize diffusion distance." },
            { q: "Heart rate during exercise?", a: ["Increases", "Decreases", "Same", "Stops"], correct: 0, explanation: "Muscles need more oxygen/glucose for respiration, so heart pumps faster." },
            { q: "Yellow liquid transporting urea?", a: ["Plasma", "Platelets", "Lymphocytes", "Phagocytes"], correct: 0, explanation: "Plasma carries dissolved substances like glucose, amino acids, urea, and CO2." },
            { q: "Phagocytosis is:", a: ["Engulfing pathogens", "Making antibodies", "Clotting", "Releasing oxygen"], correct: 0, explanation: "Phagocytes engulf and digest pathogens using enzymes." },
            { q: "Antibody producers?", a: ["Lymphocytes", "Phagocytes", "Platelets", "RBC"], correct: 0, explanation: "Lymphocytes produce specific antibodies that bind to antigens." },
            { q: "Pulmonary artery carries blood from:", a: ["Right ventricle to lungs", "Left ventricle to body", "Right atrium", "Lungs to left"], correct: 0, explanation: "Takes deoxygenated blood from right ventricle to lungs." },
            { q: "NOT transported by plasma?", a: ["Oxygen (mostly)", "Urea", "CO2", "Glucose"], correct: 0, explanation: "Oxygen is transported bound to Haemoglobin inside RBCs." }, 
            { q: "Arteries have elastic walls to:", a: ["Maintain high pressure", "Prevent backflow", "Allow diffusion", "Store blood"], correct: 0, explanation: "Elastic recoil pushes blood forward between beats." },
            { q: "Pulse rate is:", a: ["Heartbeats per minute", "Blood pressure", "Flow speed", "Blood volume"], correct: 0, explanation: "The pulse is the expansion of arteries caused by the heartbeat." },
            { q: "Body to Heart vessel?", a: ["Vena Cava", "Aorta", "Pulmonary Vein", "Carotid"], correct: 0, explanation: "Vena Cava collects used blood from the body." },
            { q: "Coronary blockage leads to:", a: ["Heart attack", "Stroke", "Kidney failure", "Diabetes"], correct: 0, explanation: "Cardiac muscle cells die without oxygen." },
            { q: "Side with oxygenated blood?", a: ["Left", "Right", "Top", "Bottom"], correct: 0, explanation: "Left side receives blood from lungs." },
            { q: "Exchange site?", a: ["Capillaries", "Arteries", "Veins", "Heart"], correct: 0, explanation: "Only capillaries have permeable walls for diffusion." },
            { q: "Fibrinogen to fibrin protein?", a: ["Thrombin", "Insulin", "Haemoglobin", "Amylase"], correct: 0, explanation: "Thrombin is the enzyme for clotting." },
            { q: "Semilunar valves location?", a: ["Base of Aorta/Pulmonary Artery", "Between atria/ventricles", "Vena Cava", "Capillaries"], correct: 0, explanation: "Prevent blood flowing back into ventricles." },
            { q: "Renal artery connects to:", a: ["Kidney", "Liver", "Lungs", "Heart"], correct: 0, explanation: "Renal = Kidney." },
            { q: "Veins vs Arteries:", a: ["Larger lumen, valves", "Thicker walls", "Higher pressure", "No valves"], correct: 0, explanation: "Large lumen reduces resistance; valves stop backflow." },
            { q: "Left ventricle thicker because:", a: ["Pumps longer distance", "Holds more blood", "Protection", "Pumps to lungs"], correct: 0, explanation: "Needs pressure to pump to entire body." },
            { q: "Cardiac cycle time?", a: ["0.8 seconds", "0.1 seconds", "2 seconds", "5 seconds"], correct: 0, explanation: "At 72bpm, one beat is ~0.8s." },
            { q: "CHD Risk factors?", a: ["Smoking, fatty diet, stress", "Exercise, Veg", "Water", "Sleep"], correct: 0, explanation: "Smoking damages walls, fat creates plaque." },
            
            // CHAPTER 12: COORDINATION
            { q: "CNS consists of:", a: ["Brain & Spinal Cord", "Brain & Nerves", "Cord & Effectors", "Nerves"], correct: 0, explanation: "CNS processes info; Nerves are PNS." },
            { q: "Receptor to CNS neurone?", a: ["Sensory", "Motor", "Relay", "Effector"], correct: 0, explanation: "Sensory neurones send signal TO the CNS." },
            { q: "Synapse is:", a: ["Junction between neurones", "Nerve cell", "Muscle", "Eye part"], correct: 0, explanation: "Gap where chemical transmission occurs." },
            { q: "Synapse signal travel?", a: ["Chemical diffusion", "Electrical", "Osmosis", "Active transport"], correct: 0, explanation: "Neurotransmitters diffuse across the gap." },
            { q: "Controls light entry?", a: ["Iris", "Lens", "Retina", "Cornea"], correct: 0, explanation: "Iris muscles change pupil size." },
            { q: "Bright light response?", a: ["Circular contract, pupil constricts", "Radial contract", "Circular relax", "Both relax"], correct: 0, explanation: "Circular muscles squeeze pupil smaller to protect retina." },
            { q: "Focus near object:", a: ["Lens thickens", "Lens thins", "Opaque", "Flat"], correct: 0, explanation: "Thick lens refracts light more." },
            { q: "Hormone definition?", a: ["Chemical from gland, in blood", "Electrical", "Blood cell", "Enzyme"], correct: 0, explanation: "Chemical messengers in plasma." },
            { q: "Adrenaline source?", a: ["Adrenal glands", "Pancreas", "Brain", "Liver"], correct: 0, explanation: "Located on top of kidneys." },
            { q: "Gravity response in plants?", a: ["Gravitropism", "Phototropism", "Hydrotropism", "Sensitivity"], correct: 0, explanation: "Growth response to gravity." },
            { q: "Auxin in shoots accumulates on:", a: ["Shaded side", "Lit side", "Top", "Bottom"], correct: 0, explanation: "Moves away from light, causing bending." },
            { q: "Auxin effect in shoots?", a: ["Elongation", "Inhibits growth", "Division", "Death"], correct: 0, explanation: "Promotes cell elongation in shoots." },
            { q: "Light-sensitive part?", a: ["Retina", "Lens", "Sclera", "Iris"], correct: 0, explanation: "Contains rods and cones." },
            { q: "Inside eyeball?", a: ["Vitreous humor", "Aqueous humor", "Air", "Blood"], correct: 0, explanation: "Jelly maintaining shape." },
            { q: "Ciliary muscles relax?", a: ["Ligaments tight, lens thins", "Ligaments slack, lens fat", "Pupil dilates", "Close eye"], correct: 0, explanation: "For distance vision." },
            { q: "Voluntary action?", a: ["Picking up pen", "Heartbeat", "Peristalsis", "Pupil reflex"], correct: 0, explanation: "Controlled by conscious brain." },
            { q: "Fovea is:", a: ["Highest cone concentration", "Blind spot", "Optic nerve", "Lens"], correct: 0, explanation: "Sharpest color vision point." },
            { q: "Rods are for:", a: ["Dim light (B&W)", "Color", "Focus", "Protection"], correct: 0, explanation: "Sensitive to low light." },
            { q: "Cones are for:", a: ["Color (bright light)", "Night", "Peripheral", "Tears"], correct: 0, explanation: "Red, Green, Blue cones." },
            { q: "Lowers blood glucose?", a: ["Insulin", "Glucagon", "Adrenaline", "Testosterone"], correct: 0, explanation: "Signals liver to store glucose." },
            { q: "Insulin producer?", a: ["Pancreas", "Liver", "Kidney", "Stomach"], correct: 0, explanation: "Islets of Langerhans." },
            { q: "Adrenaline causes:", a: ["High pulse, wide pupils", "Low pulse", "Sleep", "Small pupils"], correct: 0, explanation: "Fight or flight preparation." },
            { q: "Reflex arc effector?", a: ["Muscle", "Skin", "Spinal cord", "Brain"], correct: 0, explanation: "Muscle contracts to move limb." },
            { q: "Roots are:", a: ["+ Gravitropic", "- Gravitropic", "+ Phototropic", "Neutral"], correct: 0, explanation: "Grow down with gravity." },
            { q: "Shoots are:", a: ["+ Phototropic", "- Phototropic", "+ Gravitropic", "Hydrotropic"], correct: 0, explanation: "Grow towards light." },
            { q: "Weedkiller contains:", a: ["Synthetic Auxin", "Adrenaline", "Insulin", "Enzymes"], correct: 0, explanation: "Causes uncontrolled growth and death." },
            { q: "Neurone entirely in CNS?", a: ["Relay", "Sensory", "Motor", "Receptor"], correct: 0, explanation: "Connects sensory to motor." },
            { q: "White outer eye coat?", a: ["Sclera", "Cornea", "Choroid", "Retina"], correct: 0, explanation: "Protection." },
            { q: "Accommodation is:", a: ["Lens adjustment", "Pupil size", "Retina color", "Position"], correct: 0, explanation: "Focusing at distances." },
            { q: "Nerve impulses are:", a: ["Electrical", "Chemical", "Hormonal", "Sound"], correct: 0, explanation: "Electrical signals along axon." },
            { q: "Blind spot?", a: ["Optic nerve exit", "Lens", "Pupil", "Fovea"], correct: 0, explanation: "No rods or cones there." },
            { q: "Testosterone source?", a: ["Testes", "Ovaries", "Pancreas", "Adrenal"], correct: 0, explanation: "Male sex hormone." },
            { q: "Estrogen controls:", a: ["Female secondary characteristics", "Glucose", "Heart", "Urine"], correct: 0, explanation: "Breast dev, hips, cycle." },

            // CHAPTER 13: EXCRETION
            { q: "Excretion definition?", a: ["Removal of metabolic waste", "Removal of feces", "Breathing", "Sweating"], correct: 0, explanation: "Waste made by chemical reactions in cells." },
            { q: "Urea formed in?", a: ["Liver", "Kidney", "Bladder", "Blood"], correct: 0, explanation: "By deamination." },
            { q: "Urea comes from excess:", a: ["Amino acids", "Glucose", "Fats", "Vitamins"], correct: 0, explanation: "Nitrogen removed from amino acids." },
            { q: "Organ filtering urea?", a: ["Kidney", "Liver", "Lungs", "Pancreas"], correct: 0, explanation: "Filters blood to make urine." },
            { q: "Kidney to bladder tube?", a: ["Ureter", "Urethra", "Vena Cava", "Artery"], correct: 0, explanation: "Carries urine to storage." },
            { q: "Urine exit tube?", a: ["Urethra", "Ureter", "Oviduct", "Intestine"], correct: 0, explanation: "Exit from bladder." },
            { q: "Glomerulus function?", a: ["Filtration", "Reabsorption", "Storage", "Production"], correct: 0, explanation: "Ultrafiltration under pressure." },
            { q: "Completely reabsorbed?", a: ["Glucose", "Urea", "Water", "Salts"], correct: 0, explanation: "Body keeps all glucose." },
            { q: "Too large for filter?", a: ["Protein", "Glucose", "Urea", "Water"], correct: 0, explanation: "Proteins stay in blood." },
            { q: "Negative feedback?", a: ["Restores set point", "Increases change", "Positive", "Failure"], correct: 0, explanation: "Correction mechanism." },
            { q: "Response to heat?", a: ["Vasodilation, sweating", "Vasoconstriction", "Shivering", "Nothing"], correct: 0, explanation: "Lose heat via skin/evaporation." },
            { q: "Vasodilation is:", a: ["Widening of skin arterioles", "Narrowing", "Vein widening", "Sweating"], correct: 0, explanation: "More blood to surface to cool." },
            { q: "Sweating cools via:", a: ["Evaporation", "Cold water", "Blocking sun", "Cleaning"], correct: 0, explanation: "Phase change takes heat energy." },
            { q: "High blood glucose response?", a: ["Insulin", "Glucagon", "Adrenaline", "Urea"], correct: 0, explanation: "Pancreas releases insulin." },
            { q: "Glucagon function?", a: ["Glycogen to glucose", "Glucose to glycogen", "Digest fat", "Lower heart"], correct: 0, explanation: "Raises blood sugar." },
            { q: "Glycogen stored in:", a: ["Liver/Muscles", "Pancreas", "Blood", "Kidneys"], correct: 0, explanation: "Energy reserve." },
            { q: "Type 1 Diabetes?", a: ["Immune system destroys pancreas cells", "Sugar intake", "Obesity", "Age"], correct: 0, explanation: "No insulin produced." },
            { q: "Dialysis fluid needs:", a: ["Normal glucose level", "No glucose", "High urea", "High salt"], correct: 0, explanation: "Prevents glucose loss." },
            { q: "Deamination removes:", a: ["Nitrogen part of amino acid", "Fat", "Water", "CO2"], correct: 0, explanation: "Amine group removed." },
            { q: "Temp detection?", a: ["Skin receptors", "Hair", "Glands", "Vessels"], correct: 0, explanation: "Sensory receptors." },
            { q: "Shivering heat source?", a: ["Muscle respiration", "Friction", "Fat loss", "Blood stop"], correct: 0, explanation: "Metabolic heat." },
            { q: "Vasoconstriction blood flow?", a: ["Decreases to skin", "Increases", "Stops", "Reverses"], correct: 0, explanation: "Conserves heat internally." },
            { q: "Organ controlling glucose?", a: ["Pancreas", "Kidney", "Heart", "Stomach"], correct: 0, explanation: "Endocrine gland." },
            { q: "Main nitrogen waste?", a: ["Urea", "Ammonia", "Uric acid", "Nitrate"], correct: 0, explanation: "Mammals excrete urea." },
            { q: "Cortex is:", a: ["Outer kidney", "Inner kidney", "Tube", "Filter"], correct: 0, explanation: "Outer layer." },
            { q: "Medulla is:", a: ["Inner kidney", "Outer", "Bladder", "Vein"], correct: 0, explanation: "Inner layer." },
            { q: "Drinking lots of water?", a: ["Dilute, pale urine", "Concentrated", "Red", "Cloudy"], correct: 0, explanation: "Kidneys excrete excess." },
            { q: "Homeostasis controls:", a: ["Temp, Water, Glucose", "Digestion", "Growth", "Memory"], correct: 0, explanation: "Internal environment." },
            { q: "Goosebumps function?", a: ["Insulation", "Cooling", "Scare", "Height"], correct: 0, explanation: "Traps air layer." },
            { q: "Dirty blood to kidney?", a: ["Renal Artery", "Renal Vein", "Vena Cava", "Aorta"], correct: 0, explanation: "High urea in." },
            { q: "Liquid in tubule?", a: ["Glomerular filtrate", "Blood", "Plasma", "Urine"], correct: 0, explanation: "Filtered plasma." },
            { q: "Egestion is:", a: ["Removal of feces", "Urine", "Sweat", "Breathing"], correct: 0, explanation: "Undigested food." },
            { q: "Permeability to glucose?", a: ["Insulin", "Glucagon", "Auxin", "Adrenaline"], correct: 0, explanation: "Opens cell gates." },
            { q: "Water potential control?", a: ["Osmoregulation", "Thermoregulation", "Glucoregulation", "Respiration"], correct: 0, explanation: "Water/Salt balance." }
        ];

        // --- LOGIC ---
        let currentQ = 0;
        let score = 0;
        let shuffled = [];

        function switchTab(tabId) {
            // Update buttons
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            // Very simple robust check
            const index = tabId === 'revision' ? 0 : 1;
            document.querySelectorAll('.tab-btn')[index].classList.add('active');

            // Update Sections
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            if(tabId === 'revision') {
                document.getElementById('revision-section').classList.add('active');
            } else {
                document.getElementById('quiz-section').classList.add('active');
                if(shuffled.length === 0) startQuiz();
            }
            window.scrollTo(0,0);
        }

        function startQuiz() {
            shuffled = [...quizData].sort(() => Math.random() - 0.5);
            currentQ = 0;
            score = 0;
            document.getElementById('result-view').style.display = 'none';
            document.getElementById('quiz-ui').style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
            const data = shuffled[currentQ];
            document.getElementById('q-progress').innerText = `Q ${currentQ + 1}/${shuffled.length}`;
            document.getElementById('q-score').innerText = score;
            document.getElementById('question-text').innerText = data.q;
            
            // Progress Bar
            const pct = (currentQ / shuffled.length) * 100;
            document.getElementById('progress-fill').style.width = `${pct}%`;

            // Reset UI
            document.getElementById('explanation').style.display = 'none';
            document.getElementById('next-question-btn').style.display = 'none';
            
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';

            // Shuffle Options
            let opts = data.a.map((txt, idx) => ({ txt, isC: idx === data.correct }));
            opts.sort(() => Math.random() - 0.5);

            opts.forEach(o => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = o.txt;
                btn.onclick = () => handleAnswer(btn, o.isC, grid, data);
                grid.appendChild(btn);
            });
        }

        function handleAnswer(btn, isCorrect, grid, data) {
            // Disable all
            Array.from(grid.children).forEach(b => {
                b.style.pointerEvents = 'none';
                // Highlight correct one if wrong selected
                // (find by text content since we shuffled)
                const correctTxt = data.a[data.correct];
                if(b.innerText === correctTxt) {
                    b.classList.add('correct');
                }
            });

            if(isCorrect) {
                score++;
                document.getElementById('q-score').innerText = score;
            } else {
                btn.classList.add('wrong');
            }

            // Show Explanation
            const expBox = document.getElementById('explanation');
            document.getElementById('explanation-text').innerText = data.explanation;
            expBox.style.display = 'block';
            
            // Show Next
            const nextBtn = document.getElementById('next-question-btn');
            nextBtn.style.display = 'block';

            // Auto Scroll for Mobile
            setTimeout(() => {
                expBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 150);
        }

        function nextQuestion() {
            currentQ++;
            if(currentQ < shuffled.length) {
                loadQuestion();
                window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll back up
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-ui').style.display = 'none';
            document.getElementById('result-view').style.display = 'block';
            
            const pct = Math.round((score / shuffled.length) * 100);
            document.getElementById('final-score').innerText = `${pct}%`;

            let title = "Keep Going!";
            let msg = "Review the notes and try again.";
            
            if(pct > 89) { title = "Outstanding!"; msg = "You are ready for the exam."; }
            else if(pct > 69) { title = "Great Job!"; msg = "Solid knowledge, just polish the details."; }
            
            document.getElementById('result-title').innerText = title;
            document.getElementById('feedback-text').innerText = msg;
        }

        function restartQuiz() {
            startQuiz();
            window.scrollTo(0,0);
        }
    </script>
</body>
</html>